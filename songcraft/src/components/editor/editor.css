@reference "tailwindcss";

/**
 * Rich Text Editor Styles
 *
 * Custom styles for Tiptap editor integration with SongCraft theme system.
 * These styles complement the existing design tokens and Radix theme.
 */

/* ProseMirror Base Styles - Required for proper editor functionality */
.ProseMirror {
  white-space: pre-wrap;
  outline: none;
}

.ProseMirror p {
  margin: 0;
}

.ProseMirror p:not(:last-child) {
  margin-bottom: 0.5em;
}

/* ProseMirror content styles */
.ProseMirror strong {
  font-weight: bold;
}

.ProseMirror em {
  font-style: italic;
}

.ProseMirror u {
  text-decoration: underline;
}

.ProseMirror s {
  text-decoration: line-through;
}

.ProseMirror code {
  background-color: rgba(0, 0, 0, 0.1);
  padding: 0.1em 0.3em;
  border-radius: 0.2em;
  font-family: monospace;
  font-size: 0.9em;
}

.ProseMirror h1 {
  font-size: 1.5em;
  font-weight: bold;
  margin: 0.5em 0;
}

.ProseMirror h2 {
  font-size: 1.3em;
  font-weight: bold;
  margin: 0.4em 0;
}

.ProseMirror h3 {
  font-size: 1.1em;
  font-weight: bold;
  margin: 0.3em 0;
}

.ProseMirror ul,
.ProseMirror ol {
  padding-left: 1.5em;
  margin: 0.5em 0;
}

.ProseMirror li {
  margin: 0.2em 0;
}

.ProseMirror blockquote {
  border-left: 3px solid #ccc;
  padding-left: 1em;
  margin: 0.5em 0;
  font-style: italic;
}

/* Editor Container */
.rich-text-editor-container {
  @apply w-full;
}

/* Editor Content Area */
.rich-text-editor {
  @apply min-h-[200px] p-4 border border-gray-300 rounded-md;
  @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent;
  @apply max-w-none;

  /* Theme integration */
  @apply bg-surface-base text-fg-primary;
  @apply border-border-primary focus:ring-brand-primary;
  @apply placeholder:text-fg-tertiary;

  /* Dark mode support */
  @apply dark:bg-surface-elevated dark:text-fg-primary;
  @apply dark:border-border-secondary dark:focus:ring-brand-primary;
}

/* Toolbar Styles */
.rich-text-toolbar {
  @apply flex items-center gap-1 p-2 border-b border-gray-200 rounded-t-md;
  @apply bg-surface-elevated;
  @apply dark:border-border-secondary dark:bg-surface-base;
}

/* Toolbar Button Styles */
.rich-text-toolbar button {
  @apply p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700;
  @apply transition-colors duration-200;
  @apply focus:outline-none focus:ring-2 focus:ring-brand-primary;
}

/* Editor Content Styles */
.rich-text-editor h1 {
  @apply text-2xl font-bold text-fg-primary mb-4;
}

.rich-text-editor h2 {
  @apply text-xl font-semibold text-fg-primary mb-3;
}

.rich-text-editor h3 {
  @apply text-lg font-medium text-fg-primary mb-2;
}

.rich-text-editor p {
  @apply text-fg-primary mb-2;
}

.rich-text-editor ul,
.rich-text-editor ol {
  @apply text-fg-primary mb-2 pl-6;
}

.rich-text-editor li {
  @apply text-fg-primary mb-1;
}

.rich-text-editor a {
  @apply text-brand-primary hover:text-brand-primary/80 underline;
}

.rich-text-editor strong {
  @apply font-semibold text-fg-primary;
}

.rich-text-editor em {
  @apply italic text-fg-primary;
}

.rich-text-editor u {
  @apply underline text-fg-primary;
}

.rich-text-editor s {
  @apply line-through text-fg-secondary;
}

.rich-text-editor code {
  @apply bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-sm font-mono;
  @apply text-fg-primary;
}

/* Block Quote Styles */
.rich-text-editor blockquote {
  @apply border-l-4 border-brand-primary pl-4 italic text-fg-secondary;
  @apply bg-gray-50 dark:bg-gray-800/50 py-2 rounded-r;
}

/* List Styles */
.rich-text-editor ul {
  @apply list-disc;
}

.rich-text-editor ol {
  @apply list-decimal;
}

/* Focus and Selection Styles */
.rich-text-editor:focus {
  @apply ring-2 ring-brand-primary ring-offset-1;
}

.rich-text-editor ::selection {
  @apply bg-brand-primary/20;
}

/* Placeholder Styles */
.rich-text-editor [data-placeholder] {
  @apply text-fg-tertiary pointer-events-none;
}

/* Tiptap specific styles */
.rich-text-editor .ProseMirror {
  @apply outline-none;
}

.rich-text-editor .ProseMirror p.is-editor-empty:first-child::before {
  @apply text-fg-tertiary pointer-events-none h-0 float-left;
  content: attr(data-placeholder);
}

/* Song-specific styles for future use */
.song-section-verse {
  @apply border-l-2 border-blue-500 pl-4 bg-blue-50 dark:bg-blue-900/20;
}

.song-section-chorus {
  @apply border-l-2 border-green-500 pl-4 bg-green-50 dark:bg-green-900/20;
}

.song-section-bridge {
  @apply border-l-2 border-purple-500 pl-4 bg-purple-50 dark:bg-purple-900/20;
}

.song-section-pre-chorus {
  @apply border-l-2 border-orange-500 pl-4 bg-orange-50 dark:bg-orange-900/20;
}

.song-section-outro {
  @apply border-l-2 border-gray-500 pl-4 bg-gray-50 dark:bg-gray-900/20;
}

/* Drag Handle Styles */
.ProseMirror p[data-drag-handle="true"]::before,
.ProseMirror h1[data-drag-handle="true"]::before,
.ProseMirror h2[data-drag-handle="true"]::before,
.ProseMirror h3[data-drag-handle="true"]::before,
.ProseMirror h4[data-drag-handle="true"]::before,
.ProseMirror h5[data-drag-handle="true"]::before,
.ProseMirror h6[data-drag-handle="true"]::before {
  content: "⋮⋮";
  position: absolute;
  left: -30px;
  top: 50%;
  transform: translateY(-50%);
  cursor: grab;
  color: #9ca3af;
  font-size: 14px;
  line-height: 1;
  user-select: none;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 10;
}

.ProseMirror p[data-drag-handle="true"]:hover::before,
.ProseMirror h1[data-drag-handle="true"]:hover::before,
.ProseMirror h2[data-drag-handle="true"]:hover::before,
.ProseMirror h3[data-drag-handle="true"]:hover::before,
.ProseMirror h4[data-drag-handle="true"]:hover::before,
.ProseMirror h5[data-drag-handle="true"]:hover::before,
.ProseMirror h6[data-drag-handle="true"]:hover::before {
  opacity: 1;
  color: #6b7280;
}

/* Dark mode support for drag handles */
.dark .ProseMirror p[data-drag-handle="true"]::before,
.dark .ProseMirror h1[data-drag-handle="true"]::before,
.dark .ProseMirror h2[data-drag-handle="true"]::before,
.dark .ProseMirror h3[data-drag-handle="true"]::before,
.dark .ProseMirror h4[data-drag-handle="true"]::before,
.dark .ProseMirror h5[data-drag-handle="true"]::before,
.dark .ProseMirror h6[data-drag-handle="true"]::before {
  color: #9ca3af;
}

.dark .ProseMirror p[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h1[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h2[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h3[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h4[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h5[data-drag-handle="true"]:hover::before,
.dark .ProseMirror h6[data-drag-handle="true"]:hover::before {
  color: #d1d5db;
}

/* Ensure paragraphs have relative positioning for handles */
.ProseMirror p,
.ProseMirror h1,
.ProseMirror h2,
.ProseMirror h3,
.ProseMirror h4,
.ProseMirror h5,
.ProseMirror h6 {
  @apply relative;
}

/* Drag handle widget styles */
.drag-handle-widget {
  @apply absolute left-[-30px] top-1/2 transform -translate-y-1/2;
  @apply cursor-grab text-gray-400 text-sm leading-none;
  @apply select-none opacity-0 transition-opacity duration-200;
  @apply hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300;
  @apply z-10 p-1;
  /* Debug styles - make handles more visible */
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid #e5e7eb;
  border-radius: 2px;
}

/* Debug: Make handles always visible for testing */
.drag-handle-widget.debug {
  opacity: 1 !important;
  background: rgba(59, 130, 246, 0.1);
  border: 1px solid #3b82f6;
}

/* Make paragraphs draggable */
.ProseMirror p[draggable="true"],
.ProseMirror h1[draggable="true"],
.ProseMirror h2[draggable="true"],
.ProseMirror h3[draggable="true"],
.ProseMirror h4[draggable="true"],
.ProseMirror h5[draggable="true"],
.ProseMirror h6[draggable="true"] {
  @apply cursor-grab;
}

.ProseMirror p[draggable="true"]:hover,
.ProseMirror h1[draggable="true"]:hover,
.ProseMirror h2[draggable="true"]:hover,
.ProseMirror h3[draggable="true"]:hover,
.ProseMirror h4[draggable="true"]:hover,
.ProseMirror h5[draggable="true"]:hover,
.ProseMirror h6[draggable="true"]:hover {
  @apply bg-gray-50 dark:bg-gray-800;
}

/* Official Drag Handle Styles */
.drag-handle-official {
  @apply flex items-center justify-center;
  @apply w-6 h-6 rounded;
  @apply bg-white border border-gray-300;
  @apply cursor-grab hover:bg-gray-50;
  @apply text-gray-500 hover:text-gray-700;
  @apply transition-colors duration-200;
  @apply shadow-sm hover:shadow-md;
}

.drag-handle-official:active {
  @apply cursor-grabbing;
}

/* Dark mode support for official drag handle */
.dark .drag-handle-official {
  @apply bg-gray-800 border-gray-600;
  @apply text-gray-400 hover:text-gray-200;
  @apply hover:bg-gray-700;
}
